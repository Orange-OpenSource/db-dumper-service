#!/usr/bin/env bash
file="$2"
centmb="$1"
if [ $# -ne 2 ];
    then echo "Usage: $0 [file_size_in_bytes] [file_name]"
    exit 1
fi
cat <<EOT > "$file"
CREATE TABLE fake_table
(
    value VARCHAR(8)
);
EOT
size_beginning=`stat --printf="%s" "$file"`
head -c 5 /dev/urandom | base64 | fold -w8 | sed "s/\(.*\)/INSERT INTO fake_table VALUES \('\1'\);/" >> "$file"
size=`stat --printf="%s" "$file"`
size=$(($size - $size_beginning))
iter=$(($centmb / size))
finalbytes=$((5 * $iter))
head -c $finalbytes /dev/urandom | base64 | fold -w8 | sed "s/\(.*\)/INSERT INTO fake_table VALUES \('\1'\);/" >> "$file"